% Copyright 2023 Kieran W Harvie. All rights reserved.

\section{p-adic numbers}
\subsection{Valuation}
A function $v$ of a field is called a valuation if:
\begin{equation*}
\begin{aligned}
	v(x) =& \infty \text{\quad iff } x = 0 \\
	v(xy) =& v(x)+v(y) \\
	v(x+y) \geq& \min(v(x),v(y)) \text{\quad with equality if } v(x) \neq v(y) \\
\end{aligned}
\end{equation*}
(Note that the codomain is only required to be an abelian totally ordered group extended with $\infty$,
But I will treat is as the natural numbers.)
\\

There are three immediate corollaries of the definitions.

{\textbf{1:}}By induction on the inequality we have:
\[v\left(\sum_k x_k\right) \geq \min\left(\bigcup_k \{v(x_k)\}\right)\]

{\textbf{2:}} By setting $x=y=1$ in the second equality we have $v(1)=2v(1)$ and hence $v(1) = 0$.

{\textbf{3:}} By setting $xy=1$ in the second equality we have $v(1/x)=-v(x)$.

\subsection{p-adic numbers}
Interestingly, the amount of times a prime $p$ divides a rational number $x$ is a valuation.
Let $x = p^n\frac{a}{b}$ where $a$ and $b$ are coprime, then $v_p(x) = n$ is a valuation.
(Assuming you set $v_p(0) = \infty$).
This is easy to prove, if you need help remember that for a prime $p$ we have: $p | ab \Rightarrow p|a$ or $p|b$.
\\

The reason this is interesting is because $|x|_p = p^{-v_p(x)}$ is a metric on $\mathbb{Q}$.
Meaning we can make a new field $\mathbb{Q}_p$ by taking all the limits in $\mathbb{Q}$ as we would nomarlly do to make $\mathbb{R}$ with $|\cdot|$.
And through something called Ostrowski's theorem becomes a lot more motivated and less arbitrary way to complete $\mathbb{Q}$.
\\

But the valuation alone also provides two cool proofs that simplify previous proofs.


\subsection{Irrationality of $\sqrt{2}$}
Consider the equation:
\[x^2 = 2\]
Valuating both sides gives:
\[2v_2(x) = 1\]
But $v_2(x)$ is an integer for all rational $x$ hence the LHS is always even but the right is odd.
Hence there is no $x$ satisfying the equation and $\sqrt{2}$ is irrational.

\subsection{Valuation of the Harmonic Numbers}
The valuation of harmonic numbers is given by $v_2(H_n) = -\lfloor \log_2(n) \rfloor$.
\\

{\textbf{Lemma:}}
Let $k$ be the power of the largest power of $2$ less than $n$, i.e. $k = \lfloor \log_2(n) \rfloor$.
Let $S$ be the set $[1,n]$ excluding $2^{k}$, then from the maximality of $k$ we have:
\[\max(v_2(S)) \leq k-1\]
Since if we assume there is an $s\in S$ such that $v_2(s) > k-1$ with the codomain of $v_2$ being integers means $v_2(s) \geq k$.
This means there exists an integers $a$ and $b$ coprime to each other and $2$ such that $s= 2^k\frac{a}{b}$.
$s$ being a positive integer means $b=1$. 
$a\neq1$ since it would make $s=2^k$, which was excluded from $S$.
But $a\geq2$ would means $2^{k+1} \in S$, contradicting the maximality of $k$.
\\

Now $H_n$ can be written as the following sum:
\[H_n = \sum_{s\in S} \frac{1}{s} + 2^{-k}\]

Where the valuation of  first term is bound by:
\begin{equation*}
\begin{aligned}
	v_2\left(\sum_{s\in S}\frac{1}{s}\right) \geq& \min\left\{v_2(1/s)\,|\,s\in S\right\} \\
	=& \min\left\{-v_2(s)\,|\,s\in S\right\} \\
	=& -\max\left\{v_2(s)\,|\,s\in S\right\} \\
	=& -k+1 \\
\end{aligned}
\end{equation*}

Hence the valuations are not equal since:
\[v_2(2^{-k}) = -k < -k+1 \leq v_2\left(\sum_{s\in S}\frac{1}{s}\right)\]

Hence

\begin{equation*}
\begin{aligned}
	v_2(H_n) =& \min\left\{ v_2\left(\sum_{s\in S}\frac{1}{s}\right) , v_2(2^{-k})\right\} = -k\\
\end{aligned}
\end{equation*}

As required.
\\

Note that for $n \geq 2$ we have $k \geq 1$ and hence $v_2(H_n) \leq -1$ meaning $H_n$ isn't an integer for $n\neq1$

\subsection{Valuation of the Harmonic Numbers v2}
I think the lemma's of the previous proof can be separated and cleaned up.

{\textbf{Lemma:}} Let $S$ be a subset of the $v$'s domain with an element $s_0\in S$ such that:
\[v(S\textbackslash\{s_0\}) > v(s_0)\]
Then:
\[v\left(\sum_{s\in S}s\right) = v(s_0)\]
{\textbf{Proof:}} Plugging the inequality into the valuation inequality axiom gives:
\[ v\left(\sum_{s\in S\textbackslash\{s_0\}}s\right) \geq v(S\textbackslash\{s_0\}) > v(s_0)\]
Hence the term of the far left and far right are not equal meaning:
\begin{equation*}
\begin{aligned}
	v\left(\sum_{s\in S}s\right) =& v\left(s_0+\sum_{s\in S\textbackslash\{s_0\}}s\right) \\
	=& \min\left\{v(s_0),v\left(\sum_{s\in S\textbackslash\{s_0\}}s\right)\right\} \\
	=&v(s_0)\quad \square\\
\end{aligned}
\end{equation*}

{\textbf{Lemma:}} If $n \in \mathbb{N}$ then $v_p(n) \leq \log_p(n)$ with equality iff $n$ is a power of $p$.

{\textbf{Proof:}} Equality in the case of $n$ being a power is trivial.
Now consider $n$ not a power of $2$ meaning $n = a\,p^{v_p(n)}$ where $a > 1$, hence:
\[p^{v_p(n)} <  n = p^{\log_p(n)} \]
$\log_p$ is strictly monotonic, hence:
\[{v_p(n)} < {\log_p(n)} \]

{\textbf{Lemma:}} If $n \in \mathbb{N}$ then $v_2(n) \leq \lfloor \log_2 (n) \rfloor$ with equality iff $n$ is a power of $2$.

{\textbf{Proof:}} Equality in the case of $n$ being a power is trivial.
Assume $n$ isn't a power of $2$ then:
\[n \geq 3\cdot 2^{v_2(n)}\]
Hence:
\begin{equation*}
\begin{aligned}
	\log_2(n) \geq& \log_2(3)+v_2(n) \\
	\log_2(n)-\log_2(3) \geq& v_2(n) \\
	\lfloor\log_2(n)-\log_2(3)\rfloor \geq& \lfloor v_2(n) \rfloor \\
\end{aligned}
\end{equation*}

Since $\log_2(3) > 1$ we have:
\[\lfloor \log_2 (n) \rfloor > \lfloor\log_2(n)-\log_2(3)\rfloor\]
And $v_2(n)$ is an integer, hence:
$\lfloor \log_2 (n) \rfloor > v_2(n)\quad \square$
\\

Note that this can't be generalized to larger $p$ since the logarithm being less than one isn't guaranteed.
Compare with $p=3$ with $v_3(6) = 1 = \lfloor \log_3(6) \rfloor$ because $\log_3(2) < 1$.
Note to the previous note, in this case you can say $v_3(n) \leq \lfloor \log_p(n) \rfloor$ iff $n$ is a power of $3$ or even, which is still \emph{kind of} cool.

{\textbf{Lemma:}} Let $S_n = \left\{k^{-1} | 1 \leq k \leq n\right\}$ and $k_0 = \lfloor\log_2 n\rfloor$.
Then $2^{-k_0} \in S$ and satisfies:
\[v_2(S_n\textbackslash\{2^{-k_0}\}) > v_2(2^{-k_0})\]

{\textbf{Proof:}} $2^{k_0} = 2^{\lfloor \log_2 n \rfloor} \leq 2^{\log_2 n} = n$ hence $2^{-k_0} \in S$.
Now consider $s\in S$ then $s^{-1} \in \mathbb{N}$ which from the previous lemma means:
\[ v_2(s^{-1}) \leq \lfloor \log_2(s^{-1})\rfloor \leq \lfloor \log_2(n)\rfloor = k_0\]
With equality iff $s^{-1}$ is a power of $2$.
It's can't be a larger power than $2^{k_0}$ since $2^{\lfloor \log_2 (n) \rfloor}$ is the largest power less than or equal to $n$.
But from the definition of $S_n\textbackslash\{2^{-k_0}\}$ it can't be the same power.
Hence $s^{-1}$ can only be a lower power making the final inequality strict anyway.
Hence:
\[ v_2(s^{-1}) < k_0 \Rightarrow v_2(s) > -k_0 = v_2(2^{-k_0})\quad \square\]

Noting that $H_n = \sum_{s\in S_n}s$ means the proof that $v_2(H_n) = -\lfloor \log_2 (n) \rfloor$ follows immediately from the first and last lemmas.

%% Induction is a bad way to prove this so it has been commented out %%
%This can be proved by induction on $k$.
%\\
%
%{\textbf{Base Case:}} The base case is quite direct:
%\begin{equation*}
%\begin{aligned}
%	k=0 \Rightarrow\, & n \in [1,2) \\
%	\Rightarrow\, & n = 1 \\
%	\Rightarrow\, & H_1 = 1 \\
%	\Rightarrow\, & v_2(H_1) = 0 \\
%\end{aligned}
%\end{equation*}
%
%{\textbf{Induction:}}
%Assume that $v_2(H_n) = -k'$ when $n\in[2^{k'}, 2^{k'+1})$ for $k' < k$:
%Hence $2^{k}-1$ is in the previous step, giving $v_2(H_{2^{k}-1}) = -k+1$.
%Which is clearly not equal to $v_2(2^k)$ meaning applying the second valuation property gives:
%
%\begin{equation*}
%\begin{aligned}
%	v_2(H_{2^k}) =& v_2(H_{2^k-1} + 2^{-k}) \\
%	=& \min\big(v_2(H_{2^k-1}),v_2(2^{-k}\big)) \\
%	=& \min(-k+1,-k)\\
%	=& -k\\
%\end{aligned}
%\end{equation*}
%
%Now assume $n \in (2^k,2^{k+1})$ then $v_2(\frac{1}{n}) > -k$ since $n$ is divisible by $p$ less then $k$ times.
%
%\begin{equation*}
%\begin{aligned}
%	v_2(H_n) =& v_2(H_{2^k} + \sum_{l=2^k+1}^{n}\frac{1}{l}) \\
%\end{aligned}
%\end{equation*}
